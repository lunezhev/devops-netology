# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Ответ
- Электронные чеки в json виде  - Документно ореинтриованная БД, документальный поиск их основная сфера использования.
- Склады и автомобильные дороги для логистической компании - Возможно графовые т.к. с помощью ребер можно описывать логистику, или, возможно, сетевая где узел может иметь множество связей.
- Генеалогические деревья - иерархическая, т.к. она и по структуре напоминает генеалгическое дерево =)
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации - БД Ключ-значение, типичный пример использования.
- Отношения клиент-покупка для интернет-магазина - Реляционные БД. Возможен большой объем собираемых данных, которые лучше хранить в таблицах.

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

## Ответ
- Данные записываются на все узлы с задержкой до часа (асинхронная запись) - CP (система отдаёт предпочтение целостности перед доступностью); PA/EL (при разделении данные доступны, но не консистентны, при отсутствии разделения приоритет отдается задержке)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера - PA (в описании реализации говорится о том, что в случае отсутствия связи между узлами данные остаются доступными); PA/EC (возможно PA/EL) (при разделении есть доступность, но нет консистентности, при отсутствии разделения не указан приоритет, поэтому может быть как EC, так и EL)
- Система может не прислать корректный ответ или сбросить соединение - CP (система может сбросить соединение, нет доступности); PC/EC (при разделении нет доступности, при отсутствии разделения система сохраняет консистентность)

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

## Ответ
Принципы BASE и ACID не могут сочетаться, они противопоставлены друг другу. Принцип base - доступность данных без согласовааности. ACID согласованность данных и надежность.

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?

## Ответ
В данном случае подходят Redis.

Минусы:
Однопоточнось и все, что из этого вытекает. Например задержки, связаные с выполнением медленных команд (SORT, LREM, SUNION). 
Также, при синке на диск (если включено сохранение AOF, Redis должен разветвить фоновые процессы), Операция fork (выполняется в основном потоке) сама по себе может вызвать задержку. Разветвление  требует времени и ресурсов ЦП, особенно на виртуальных машинах, где выделение и инициализация большого фрагмента памяти могут быть дорогостоящими.

---

### Как cдавать задание

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
